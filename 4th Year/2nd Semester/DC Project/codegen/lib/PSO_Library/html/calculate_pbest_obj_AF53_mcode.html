<pre class="code">
<span class="srcline"><span class="lineno"><a href="31,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T17U3">iterbest</span>,<span class="var type1" id="S3T17U4">pbest</span>,<span class="var type1" id="S4T16U5">oldpfitness</span>,<span class="var type1" id="S5T1U6">indx</span>,<span class="var type1" id="S6T1U7">bestfitness</span>] = calculate_pbest_obj_AF(<span class="var type1" id="S7T17U10">pos</span>, <span class="mxinfo" id="T17:U7"><span class="mxinfo" id="T17:U8"><span class="var type1" id="S3T17U11">pbest</span></span></span>,<span class="mxinfo" id="T16:U10"><span class="mxinfo" id="T16:U11"><span class="var type1" id="S4T16U12">oldpfitness</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="31,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,3" id="srcline3"> 3</a></span><span class="line">coder.inline(<span class="string">'never'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="31,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%calculate personal best , iterbest and bestfitness</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo" id="T1:U13"><span class="var type1" id="S9T1U21">fay1</span>=<span class="mxinfo" id="T1:U15">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T1:U16"><span class="var type1" id="S10T1U25">fay2</span>=<span class="mxinfo" id="T1:U18">90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T1:U19"><span class="var type1" id="S11T1U29">fay3</span>=<span class="mxinfo" id="T1:U21">180</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T1:U22"><span class="var type1" id="S12T1U33">fay4</span>=<span class="mxinfo" id="T1:U24">30</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo" id="T1:U25"><span class="var type1" id="S13T1U37">no_of_particle</span>=<span class="mxinfo" id="T1:U27">90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,13" id="srcline13">13</a></span><span class="line"><span class="comment">%Duplicated Code</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo" id="T1:U28"><span class="var type1" id="S14T1U41">n</span>=<span class="mxinfo" id="T1:U30">24</span></span>;                            <span class="comment">%number of antenna element in the array</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo" id="T1:U31"><span class="var type1" id="S15T1U45">degreestep</span>=<span class="mxinfo" id="T1:U33"><span class="mxinfo" id="T1:U34">360</span>/<span class="mxinfo" id="T1:U35"><span class="var type1" id="S14T1U48">n</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo" id="T1:U37"><span class="var type1" id="S16T1U51">wl</span>=<span class="mxinfo" id="T1:U39">1</span></span>;                            <span class="comment">%wave length</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo" id="T1:U40"><span class="var type1" id="S17T1U55">d</span>=<span class="mxinfo" id="T1:U42">0.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo" id="T1:U43"><span class="var type1" id="S18T1U59">beta</span>=<span class="mxinfo" id="T1:U45">(2*pi)/<span class="var type1" id="S16T1U66">wl</span></span></span>;                  <span class="comment">%phase shift</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T1:U47"><span class="var type1" id="S20T1U69">seta</span>=<span class="mxinfo" id="T1:U49">90</span></span>;                         <span class="comment">%because we will work only on horizontal level (in 2d)so zaxis will be 90</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo" id="T1:U50"><span class="var type1" id="S21T1U73">r1</span>=<span class="mxinfo" id="T1:U52">(<span class="var type1" id="S14T1U78">n</span>*<span class="var type1" id="S17T1U79">d</span>*<span class="var type1" id="S16T1U80">wl</span>)/(2*pi)</span></span>;              <span class="comment">%radius of the circle</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo" id="T19:U56"><span class="var type1" id="S22T19U88">I</span>=<span class="mxinfo" id="T19:U58"><span class="var type1" id="S7T17U90">pos</span>(<span class="mxinfo" id="T22:U60"><span class="mxinfo" id="T1:U61">1</span>:<span class="mxinfo" id="T1:U62">90</span></span>,<span class="mxinfo" id="T25:U63"><span class="mxinfo" id="T1:U64">1</span>:<span class="mxinfo" id="T1:U65">24</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo" id="T19:U66"><span class="var type1" id="S23T19U99">phase</span>=<span class="mxinfo" id="T19:U68"><span class="var type1" id="S7T17U101">pos</span>(<span class="mxinfo" id="T22:U70"><span class="mxinfo" id="T1:U71">1</span>:<span class="mxinfo" id="T1:U72">90</span></span>,<span class="mxinfo" id="T25:U73"><span class="mxinfo" id="T1:U74">25</span>:<span class="mxinfo" id="T1:U75">48</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,25" id="srcline25">25</a></span><span class="line"><span class="comment">%Initialize Postion Vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T3:U76"><span class="var type1" id="S24T3U110">postion</span> = <span class="mxinfo" id="T3:U78">zeros(<span class="mxinfo" id="T1:U79">1</span>,<span class="mxinfo" id="T1:U80"><span class="var type1" id="S14T1U114">n</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,28" id="srcline28">28</a></span><span class="line"><span class="comment">%Set Initial Value</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T1:U82"><span class="mxinfo" id="T1:U83"><span class="var type1" id="S24T3U118">postion</span>(<span class="mxinfo" id="T1:U85">1</span>)</span>=<span class="mxinfo" id="T1:U86">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,31" id="srcline31">31</a></span><span class="line"><span class="comment">% from 2 to n</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,32" id="srcline32">32</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S26T1U123">i</span>=<span class="mxinfo" id="T1:U88">2</span>:<span class="var type1" id="S14T1U126">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo" id="T1:U90"><span class="mxinfo" id="T1:U91"><span class="var type1" id="S24T3U130">postion</span>(<span class="var type1" id="S26T1U131">i</span>)</span>=<span class="mxinfo" id="T1:U94"><span class="mxinfo" id="T1:U95"><span class="var type1" id="S24T3U134">postion</span>(<span class="mxinfo" id="T1:U97"><span class="var type1" id="S26T1U136">i</span>-<span class="mxinfo" id="T1:U99">1</span></span>)</span>+<span class="var type1" id="S15T1U138">degreestep</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,34" id="srcline34">34</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,35" id="srcline35">35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,36" id="srcline36">36</a></span><span class="line"><span class="comment">%end of %Duplicated Code</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo" id="T19:U101"><span class="var type1" id="S27T19U141">temp</span>=<span class="mxinfo" id="T19:U103">repmat(<span class="mxinfo" id="T3:U104"><span class="mxinfo" id="T1:U105"><span class="mxinfo" id="T1:U106"><span class="var type1" id="S18T1U147">beta</span>.*<span class="var type1" id="S21T1U148">r1</span></span>.*<span class="mxinfo" id="T1:U109">sind(<span class="mxinfo" id="T1:U110"><span class="var type1" id="S20T1U151">seta</span></span>)</span></span>.*<span class="mxinfo" id="T3:U112">cosd(<span class="mxinfo" id="T3:U113"><span class="var type1" id="S9T1U155">fay1</span>-<span class="var type1" id="S24T3U156">postion</span></span>)</span></span>,<span class="var type1" id="S13T1U157">no_of_particle</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo" id="T20:U117"><span class="var type1" id="S31T20U161">elements</span>=<span class="mxinfo" id="T20:U119"><span class="var type1" id="S22T19U163">I</span>.*<span class="mxinfo" id="T20:U121">exp(<span class="mxinfo" id="T20:U122"><span class="mxinfo" id="T9:U123">1i</span>.*(<span class="mxinfo" id="T19:U124"><span class="var type1" id="S27T19U170">temp</span>-<span class="var type1" id="S23T19U171">phase</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo" id="T21:U127"><span class="var type1" id="S33T21U174">AFfay1</span>=<span class="mxinfo" id="T21:U129">sum(<span class="var type1" id="S31T20U177">elements</span>,2)</span></span>;                         <span class="comment">%for all particles</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo" id="T19:U131"><span class="var type1" id="S27T19U181">temp</span>=<span class="mxinfo" id="T19:U133">repmat(<span class="mxinfo" id="T3:U134"><span class="mxinfo" id="T1:U135"><span class="mxinfo" id="T1:U136"><span class="var type1" id="S18T1U187">beta</span>.*<span class="var type1" id="S21T1U188">r1</span></span>.*<span class="mxinfo" id="T1:U139">sind(<span class="mxinfo" id="T1:U140"><span class="var type1" id="S20T1U191">seta</span></span>)</span></span>.*<span class="mxinfo" id="T3:U142">cosd(<span class="mxinfo" id="T3:U143"><span class="var type1" id="S10T1U195">fay2</span>-<span class="var type1" id="S24T3U196">postion</span></span>)</span></span>,<span class="var type1" id="S13T1U197">no_of_particle</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo" id="T20:U147"><span class="var type1" id="S31T20U201">elements</span>=<span class="mxinfo" id="T20:U149"><span class="var type1" id="S22T19U203">I</span>.*<span class="mxinfo" id="T20:U151">exp(<span class="mxinfo" id="T20:U152"><span class="mxinfo" id="T9:U153">1i</span>.*(<span class="mxinfo" id="T19:U154"><span class="var type1" id="S27T19U210">temp</span>-<span class="var type1" id="S23T19U211">phase</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo" id="T21:U157"><span class="var type1" id="S35T21U214">AFfay2</span>=<span class="mxinfo" id="T21:U159">sum(<span class="var type1" id="S31T20U217">elements</span>,2)</span></span>;                         <span class="comment">%for all particles</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,45" id="srcline45">45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,46" id="srcline46">46</a></span><span class="line"><span class="mxinfo" id="T19:U161"><span class="var type1" id="S27T19U221">temp</span>=<span class="mxinfo" id="T19:U163">repmat(<span class="mxinfo" id="T3:U164"><span class="mxinfo" id="T1:U165"><span class="mxinfo" id="T1:U166"><span class="var type1" id="S18T1U227">beta</span>.*<span class="var type1" id="S21T1U228">r1</span></span>.*<span class="mxinfo" id="T1:U169">sind(<span class="mxinfo" id="T1:U170"><span class="var type1" id="S20T1U231">seta</span></span>)</span></span>.*<span class="mxinfo" id="T3:U172">cosd(<span class="mxinfo" id="T3:U173"><span class="var type1" id="S11T1U235">fay3</span>-<span class="var type1" id="S24T3U236">postion</span></span>)</span></span>,<span class="var type1" id="S13T1U237">no_of_particle</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo" id="T20:U177"><span class="var type1" id="S31T20U241">elements</span>=<span class="mxinfo" id="T20:U179"><span class="var type1" id="S22T19U243">I</span>.*<span class="mxinfo" id="T20:U181">exp(<span class="mxinfo" id="T20:U182"><span class="mxinfo" id="T9:U183">1i</span>.*(<span class="mxinfo" id="T19:U184"><span class="var type1" id="S27T19U250">temp</span>-<span class="var type1" id="S23T19U251">phase</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo" id="T21:U187"><span class="var type1" id="S36T21U254">AFfay3</span>=<span class="mxinfo" id="T21:U189">sum(<span class="var type1" id="S31T20U257">elements</span>,2)</span></span>;                         <span class="comment">%for all particles</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,49" id="srcline49">49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,50" id="srcline50">50</a></span><span class="line"><span class="mxinfo" id="T19:U191"><span class="var type1" id="S27T19U261">temp</span>=<span class="mxinfo" id="T19:U193">repmat(<span class="mxinfo" id="T3:U194"><span class="mxinfo" id="T1:U195"><span class="mxinfo" id="T1:U196"><span class="var type1" id="S18T1U267">beta</span>.*<span class="var type1" id="S21T1U268">r1</span></span>.*<span class="mxinfo" id="T1:U199">sind(<span class="mxinfo" id="T1:U200"><span class="var type1" id="S20T1U271">seta</span></span>)</span></span>.*<span class="mxinfo" id="T3:U202">cosd(<span class="mxinfo" id="T3:U203"><span class="var type1" id="S12T1U275">fay4</span>-<span class="var type1" id="S24T3U276">postion</span></span>)</span></span>,<span class="var type1" id="S13T1U277">no_of_particle</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,51" id="srcline51">51</a></span><span class="line"><span class="mxinfo" id="T20:U207"><span class="var type1" id="S31T20U281">elements</span>=<span class="mxinfo" id="T20:U209"><span class="var type1" id="S22T19U283">I</span>.*<span class="mxinfo" id="T20:U211">exp(<span class="mxinfo" id="T20:U212"><span class="mxinfo" id="T9:U213">1i</span>.*(<span class="mxinfo" id="T19:U214"><span class="var type1" id="S27T19U290">temp</span>-<span class="var type1" id="S23T19U291">phase</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,52" id="srcline52">52</a></span><span class="line"><span class="mxinfo" id="T21:U217"><span class="var type1" id="S37T21U294">AFfay4</span>=<span class="mxinfo" id="T21:U219">sum(<span class="var type1" id="S31T20U297">elements</span>,2)</span></span>;                         <span class="comment">%for all particles</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,53" id="srcline53">53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo" id="T22:U221"><span class="var type1" id="S38T22U301">fitness</span>=<span class="mxinfo" id="T22:U223"><span class="mxinfo" id="T22:U224"><span class="mxinfo" id="T22:U225"><span class="mxinfo" id="T22:U226">abs(<span class="var type1" id="S33T21U307">AFfay1</span>)</span>+<span class="mxinfo" id="T22:U228">abs(<span class="var type1" id="S35T21U310">AFfay2</span>)</span></span>+<span class="mxinfo" id="T22:U230">abs(<span class="var type1" id="S36T21U313">AFfay3</span>)</span></span>-<span class="mxinfo" id="T22:U232">abs(<span class="var type1" id="S37T21U316">AFfay4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,56" id="srcline56">56</a></span><span class="line"><span class="mxinfo" id="T1:U234">[<span class="var type1" id="S6T1U320">bestfitness</span>,<span class="var type1" id="S5T1U321">indx</span>]=max(<span class="var type1" id="S38T22U324">fitness</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo" id="T2:U238"><span class="var type1" id="S2T2U327">iterbest</span>=<span class="mxinfo" id="T2:U240"><span class="var type1" id="S7T17U329">pos</span>(<span class="var type1" id="S5T1U330">indx</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,58" id="srcline58">58</a></span><span class="line"><span class="mxinfo" id="T17:U243"><span class="var type1" id="S2T17U334">iterbest</span>=<span class="mxinfo" id="T17:U245">repmat(<span class="var type1" id="S2T2U337">iterbest</span>,<span class="var type1" id="S13T1U338">no_of_particle</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,59" id="srcline59">59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,60" id="srcline60">60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="31,61" id="srcline61">61</a></span><span class="line"><span class="comment">%pbest = zeros(no_of_particle,2*n);</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,62" id="srcline62">62</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S41T1U342">P</span>=<span class="mxinfo" id="T1:U249">1</span>:<span class="var type1" id="S13T1U345">no_of_particle</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,63" id="srcline63">63</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo" id="T4:U251"><span class="mxinfo" id="T1:U252"><span class="var type1" id="S38T22U351">fitness</span>(<span class="var type1" id="S41T1U352">P</span>)</span>&gt;<span class="mxinfo" id="T1:U255"><span class="var type1" id="S4T16U354">oldpfitness</span>(<span class="var type1" id="S41T1U355">P</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="31,64" id="srcline64">64</a></span><span class="line">        <span class="mxinfo" id="T2:U258"><span class="mxinfo" id="T2:U259"><span class="var type1" id="S3T17U359">pbest</span>(<span class="var type1" id="S41T1U360">P</span>,:)</span>=<span class="mxinfo" id="T2:U262"><span class="var type1" id="S7T17U363">pos</span>(<span class="var type1" id="S41T1U364">P</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,65" id="srcline65">65</a></span><span class="line">        <span class="mxinfo" id="T1:U265"><span class="mxinfo" id="T1:U266"><span class="var type1" id="S4T16U369">oldpfitness</span>(<span class="var type1" id="S41T1U370">P</span>)</span>=<span class="mxinfo" id="T1:U269"><span class="var type1" id="S38T22U372">fitness</span>(<span class="var type1" id="S41T1U373">P</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="31,66" id="srcline66">66</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,67" id="srcline67">67</a></span><span class="line">    <span class="comment">% oldpfitness(P)=fitness(P);</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,68" id="srcline68">68</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="31,69" id="srcline69">69</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
